(void 0===window.QSI.InfoBar||window.QTest)&&(QSI.InfoBar=QSI.util.Creative(QSI.BuildElementModule,{initialize:function(a){this.globalInitialize(a),this.shouldAnchor=!0,this.removed=!1,this.infoBarOptions=this.options.infoBarOptions||{},this.position="top",this.insertIntoBody=this.options.displayOptions.insertIntoBody,this.animate=void 0===this.options.displayOptions.animate||this.options.displayOptions.animate===!0,this.shouldShow()&&this.display()},display:function(){this.options.elements?(this.elements=this.options.elements.Elements||[],QSI.util.processLocators(this.elements,this.displayOptions),this.bar=this.build(),this.width&&this.height&&(this.options.size={width:this.width,height:this.height})):this.infoBarOptions&&(this.options.locators&&(QSI.PipedText.setLocators(this.options.locators),this.infoBarOptions.content=QSI.PipedText.evaluateLocators(this.infoBarOptions.content,this.displayOptions)),this.bar=this.buildLegacy());var a=this;QSI.util.when(QSI.util.getTimeout(this.displayOptions.delay)).done(function(){a.removed||(a.popup(),a.poppedUp=!0)})},popup:function(){try{var a=this;this.resetStyles();var b=1e3*this.displayOptions.close;0!==b&&this.displayed.done(function(){window.setTimeout(function(){a.close()},b)}),document.body.appendChild(this.bar);var c={x:0,y:0},d=QSI.util.getDimensions(this.bar).height;if(this.bar.style.zIndex=QSI.global.currentZIndex++,this.options.elements)this.animate&&this.insertIntoBody&&(this.bar.style.height=0);else{var e=this.infoBarClose.offsetHeight;QSI.util.$(this.infoBarClose).style.top=d/2-e/2+"px",this.position=this.infoBarOptions.position}var f=-d;if(this.insertIntoPage||(f=-this.height),"bottom"==this.position?(this.bar.style.bottom=f+"px",this.bar.style.top="auto"):this.bar.style.top=f+"px",this.bar.style.left=c.x,this.target=c,this.insertIntoBody)if("top"==this.position){this.bar.style.top="auto";var g=document.body.firstChild;document.body.insertBefore(this.bar,g)}else this.bar.style.bottom="auto",document.body.appendChild(this.bar);this.initializeIframes();var h;h=this.animate?1500:0,this.bar.loadingDeferred.done(function(){a.slide(h)})}catch(i){QSI.dbg.e(i)}},getYPosition:function(a){return"bottom"==this.position?parseInt(a.bottom,10):1*a.top},buildLegacy:function(){this.infoBarInner=QSI.util.build("div",{className:"InfoBarInner",style:{margin:"10px"}}),this.infoBarInner.innerHTML=this.infoBarOptions.content,this.infoBarClose=QSI.util.build("img",{className:"InfoBarClose",src:QSI.global.imagePath+"/siteintercept/square_x.png",style:{right:"12px",position:"absolute",top:"5px",cursor:"pointer"},alt:"Close"});var a="fixed";QSI.util.isFixed()||(a="absolute");var b="100%";this.infoBarOuter=QSI.util.build("div",{className:"QSIInfoBar InfoBarOuter",style:{backgroundColor:this.infoBarOptions.color,position:a,top:"0px",left:"0px",width:b,cursor:"pointer",zIndex:QSI.global.currentZIndex++}},[this.infoBarInner,this.infoBarClose]);var c=this;return this.infoBarOuter.onclick=function(){c.onTargetClick()},this.infoBarClose.onclick=function(a){a=a||window.event,a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation(),c.onCloseClick()},this.infoBarOuter},build:function(){for(var a=[],b=0,c=0,d=0,e=[],f=0,g=this.elements.length;g>f;f++){var h=this.buildElement(this.elements[f]);h&&(h.style&&h.style.borderWidth&&(d=2*parseInt(h.style.borderWidth,10)),h.bc&&h.bc.x+d>b&&(b=h.bc.x+d),h.bc&&h.bc.y+d>c&&(c=h.bc.y+d),a.push(h),e.push(h.loadingDeferred))}this.width=b,this.height=c;var i="fixed";QSI.util.isFixed()?this.insertIntoBody&&(i="relative"):i="absolute";var j=this.height,k=QSI.util.build("div",{className:"QSIInfoBar "+this.id+"_InfoBarContainer",style:{width:"100%",height:j+"px",overflow:"hidden",position:i}},a);return k.loadingDeferred=QSI.util.when.apply(this,e),k},close:function(){try{this.removed=!0,QSI.util.remove(this.bar),QSI.callbacks[this.id].onClose&&QSI.callbacks[this.id].onClose()}catch(a){}},onCloseClick:function(){this.close()},slide:function(a){var b,c=this,d={};this.insertIntoBody?d.height=this.height:d[this.position]=0,b=QSI.Animation.animateStyle(this.bar,d,a,"inquad"),b.done(function(){c.finish()})},finish:function(){this.impress(),this.displayed.resolve(),QSI.util.isFixed()||QSI.util.positionFixed(this.bar,0,"auto")},inquad:function(a){return a*a}}));
